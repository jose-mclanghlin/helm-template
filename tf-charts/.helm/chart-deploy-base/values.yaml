namespace:
  enabled: true
  name: "example-app"
  labels:
    owner: "platform-team"
    team: "engineering"
  istioInjection: false
  goldilocksEnabled: false

configMap:
  enabled: true
  name: "example-app-config"
  annotations:
    description: "Configuration for the Example App service"
  data:
    APP_ENV: "development"
    APP_DEBUG: "true"
    LOG_LEVEL: "debug"

secret:
  enabled: true
  name: "example-app-secrets"
  annotations:
    description: "Secrets for the Example App service"
  labels:
    name: "example-app-secrets"
  data:
    DB_PASSWORD: "your-secret-password"
    API_KEY: "your-api-key-value"

service:
  name: "example-app-service"
  type: ClusterIP
  port: 80
  targetPort: 8080
  selector:
    app: "example-app"

deployment:
  name: "example-app-deployment"
  replicas: 2
  minReadySeconds: 0
  revisionHistoryLimit: 3
  progressDeadlineSeconds: 600
  enableStrategy: true
  strategy:
    type: RollingUpdate
    rollingUpdate:
      maxUnavailable: 1
      maxSurge: 1
  labels:
    app: "example-app"
  annotations:
    description: "Deployment for the Example App service"
  podAnnotations:
    prometheus.io/scrape: "true"
    prometheus.io/port: "8080"
    prometheus.io/path: "/metrics"
  enablePodSecurityContext: true
  podSecurityContext:
    runAsUser: 1000
    runAsGroup: 3000
    fsGroup: 2000
    seccompProfile:
      type: RuntimeDefault
  serviceAccount:
    name: "secrets-reader"
  initContainers: 
    - name: init-myservice
      image: busybox:1.36
      command: ['sh', '-c', 'echo Init container running...; sleep 5']
  container:
    name: "app-container"
    image: "your-registry/your-app"
    command: ["/bin/sh", "-c", "echo Hello, Kubernetes! && sleep 3600"]
    arguments: [
      "echo 'Init app'; ./start-app.sh"
    ]
    imagePullPolicy: IfNotPresent
    ports:
      - containerPort: 80
    envFrom:
      - configMapRef:
          name: "example-app-config"
      - secretRef:
          name: "example-app-secrets"
    enableStaticEnv: false
    env: # Static environment variables
      - name: "STATIC_ENV"
        value: "static_value"
      - name: "ANOTHER_ENV"
        value: "another_value"
    enableVolumeMounts: false
    volumeMounts:
      - name: "config-volume"
        mountPath: "/etc/config"
        readOnly: true
      - name: "secret-volume"
        mountPath: "/etc/secret"
        readOnly: true
    enableVolumes: false
    volumes:
      - name: "config-volume"
        persistentVolumeClaim:
          claimName: "config-pvc"
    resources:
      limits:
        cpu: "250m"
        memory: "256Mi"
      requests:
        cpu: "100m"
        memory: "128Mi"
    livenessProbe:
      httpGet:
        path: /
        port: 80
      initialDelaySeconds: 5
      periodSeconds: 10
    readinessProbe:
      httpGet:
        path: /
        port: 80
      initialDelaySeconds: 5
      periodSeconds: 10
    startupProbe:
      #    The startupProbe is used to check if the application
      #    has successfully started before running livenessProbe/readinessProbe.
      #    It is ideal when the app takes a long time to initialize 
      #    (e.g., migrations, warmup).
      httpGet:
        path: /startup
        port: 80
      initialDelaySeconds: 0
      periodSeconds: 10
      timeoutSeconds: 2
      failureThreshold: 30
    enableContainerSecurityContext: true
    securityContext:
      allowPrivilegeEscalation: false
      capabilities:
        drop:
          - ALL
      privileged: false
      readOnlyRootFilesystem: true
    enableImagePullSecrets: false
    imagePullSecrets:
      - name: "registry-secret"
    enablePodAntiAffinity: false
    affinity:
      nodeAffinity:
        requiredDuringSchedulingIgnoredDuringExecution:
          nodeSelectorTerms:
            - matchExpressions:
                - key: kubernetes.io/os
                  operator: In
                  values:
                    - linux
        preferredDuringSchedulingIgnoredDuringExecution:
          - weight: 1
            preference:
              matchExpressions:
                - key: topology.kubernetes.io/zone
                  operator: In
                  values:
                    - us-east-1a
      antiAffinity:
        podAntiAffinity:
          requiredDuringSchedulingIgnoredDuringExecution:
            - labelSelector:
                matchExpressions:
                  - key: app
                    operator: In
                    values:
                      - example-app
              topologyKey: "kubernetes.io/hostname"
      podAntiAffinity:
        preferredDuringSchedulingIgnoredDuringExecution:
          - weight: 1
            podAffinityTerm:
              labelSelector:
                matchExpressions:
                  - key: app
                    operator: In
                    values:
                      - example-app
              topologyKey: "topology.kubernetes.io/zone"
  # If you don't want to restrict pod scheduling, leave it empty:
  # nodeSelector: {}
  # Example of nodeSelector to schedule pods on specific nodes:
  # kubernetes.io/hostname: worker-node-1
  nodeSelector: {}
  
  # Topology Spread Constraints for pod distribution across nodes/zones
  topologySpreadConstraints: []
  # Example configuration:
  # topologySpreadConstraints:
  #   - labelSelector:
  #       matchLabels:
  #         app: example-app
  #     maxSkew: 1
  #     topologyKey: kubernetes.io/hostname
  #     whenUnsatisfiable: ScheduleAnyway
  #   - labelSelector:
  #       matchLabels:
  #         app: example-app
  #     maxSkew: 1
  #     topologyKey: topology.kubernetes.io/zone
  #     whenUnsatisfiable: DoNotSchedule

pvc:
  enabled: false
  name: "example-app-pvc"
  labels:
    app: "example-app"
  accessMode: ReadWriteOnce
  size: 1Gi
  storageClass: "standard"

virtualService:
  enabled: false
  name: "example-app-vs"
  namespace: "example-app"
  host: "app.example.com"
  gateway: "app-gateway"
  uriPrefix: "/"
  destinationHost: "example-app-service"
  destinationPort: 80
  # Optional routing rules
  method: GET
  headerUser: admin
  queryVersion: v2
  labels:
    app: "example-app"
  timeout: "30s"
  retries:
    attempts: 3
    perTryTimeout: 2s
    retryOn: "5xx,gateway-error,connect-failure,refused-stream"

hpa:
  enabled: false
  name: "example-app-hpa"
  minReplicas: 1
  maxReplicas: 5
  targetCPUUtilizationPercentage: 80
  targetMemoryUtilizationPercentage: 75
  labels:
    app: "example-app"

vpa:
  enabled: false
  name: "example-app-vpa"
  updateMode: "Auto" # Options: "Off", "Initial", "Auto"
  containerName: "app-container"
  minAllowed:
    cpu: 100m
    memory: 256Mi
  maxAllowed:
    cpu: 1
    memory: 1Gi
  labels:
    app: "example-app"
  controlledResources: 
    - cpu
    - memory

externalSecret:
  enabled: false
  name: "example-app-external-secret"
  namespace: "example-app"
  labels:
    app: "example-app"
  secretStoreRef:
    name: "aws-secrets"
    kind: "SecretStore" # or "ClusterSecretStore"
  data:
    - secretKey: "DB_PASSWORD"
      remoteKey: "path/to/secret/in/vault"
    - secretKey: "API_KEY"
      remoteKey: "path/to/another/secret"

registry:
  enabled: false
  secretName: your-registry-secret
  host: registry.example.com
  user: your_registry_user
  pwd: your_registry_password

ingress:
  enabled: true
  name: "example-app-ingress"
  className: "nginx"
  enableTLS: false
  labels:
    environment: "development"
    team: "engineering"
  annotations:
    nginx.ingress.kubernetes.io/cors-allow-headers: "x-api-key,authorization,content-type"
    nginx.ingress.kubernetes.io/enable-cors: "true"
    nginx.ingress.kubernetes.io/force-ssl-redirect: "false"
    nginx.ingress.kubernetes.io/proxy-connect-timeout: "300"
    nginx.ingress.kubernetes.io/proxy-read-timeout: "300"
    nginx.ingress.kubernetes.io/proxy-send-timeout: "300"
    nginx.ingress.kubernetes.io/ssl-redirect: "false"
  hosts:
    - host: "dev-api.example.com"
      paths:
        - path: "/app"
          pathType: "Prefix"
          serviceName: "example-app-service"  # Override service name if needed
          servicePort: 80
        - path: "/api/app"
          pathType: "Prefix"
          servicePort: 80
        - path: "/health"
          pathType: "Exact"
          servicePort: 80
  tls:
    - hosts:
        - "dev-api.example.com"

podDisruptionBudget:
  enabled: false
  name: "example-app-pdb"
  labels:
    environment: "development"
    team: "engineering"
  annotations: {} 
  minAvailable: 1
  maxUnavailable: null
  selector: {}